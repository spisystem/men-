<!DOCTYPE html>
<html lang="it" dir="ltr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Menù Ordine Multilingue con Carrello e WhatsApp</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 20px;
    background: #fafafa;
    color: #222;
    transition: background-color 0.3s, color 0.3s;
  }
  body[dir="rtl"] {
    direction: rtl;
  }
  h1, h2 {
    margin-bottom: 10px;
  }
  /* Lingue */
  #language-selector {
    margin-bottom: 20px;
  }
  #language-selector button {
    border: none;
    background: transparent;
    cursor: pointer;
    font-size: 24px;
    margin-right: 10px;
    transition: transform 0.2s;
  }
  #language-selector button:focus,
  #language-selector button:hover {
    transform: scale(1.2);
  }
  /* Menu statico */
  #menu-static {
    border: 1px solid #ccc;
    padding: 15px;
    max-width: 700px;
    background: white;
    margin-bottom: 20px;
    border-radius: 6px;
  }
  .category {
    margin-bottom: 15px;
  }
  .category > h3 {
    border-bottom: 2px solid #4a90e2;
    padding-bottom: 5px;
    margin-bottom: 10px;
    color: #2c3e50;
  }
  .dish {
    padding: 4px 0;
    border-bottom: 1px dotted #ccc;
    display: flex;
    justify-content: space-between;
  }
  .dish:last-child {
    border-bottom: none;
  }
  .dish .price {
    font-weight: bold;
    color: #27ae60;
  }
  /* Bottone per aprire form */
  #open-order-btn {
    display: inline-block;
    background: #4a90e2;
    color: white;
    padding: 10px 20px;
    border-radius: 6px;
    cursor: pointer;
    border: none;
    font-size: 16px;
    transition: background-color 0.3s;
  }
  #open-order-btn:hover,
  #open-order-btn:focus {
    background: #357ABD;
  }
  /* Form ordinazione */
  #order-form-container {
    margin-top: 20px;
    max-width: 700px;
    background: white;
    border: 1px solid #ccc;
    border-radius: 6px;
    padding: 15px;
    display: none;
  }
  #order-form fieldset {
    border: none;
    margin-bottom: 15px;
  }
  #order-form label {
    display: block;
    margin-bottom: 6px;
    font-weight: 600;
  }
  #order-form select,
  #order-form input[type="number"],
  #order-form input[type="text"],
  #order-form input[type="tel"],
  #order-form input[type="email"],
  #order-form textarea {
    width: 100%;
    padding: 6px 8px;
    font-size: 14px;
    border: 1px solid #bbb;
    border-radius: 4px;
    box-sizing: border-box;
    margin-bottom: 10px;
    resize: vertical;
  }
  #order-form input[type="number"] {
    max-width: 80px;
  }
  /* Carrello e riepilogo */
  #cart-summary {
    margin-top: 20px;
    background: #e8f5e9;
    border: 1px solid #27ae60;
    border-radius: 6px;
    padding: 10px;
  }
  #cart-summary ul {
    list-style: none;
    padding-left: 0;
  }
  #cart-summary ul li {
    margin-bottom: 6px;
  }
  #cart-total {
    font-weight: bold;
    margin-top: 10px;
  }
  /* Pulsante invio */
  #send-order-btn {
    background: #27ae60;
    border: none;
    color: white;
    font-size: 18px;
    padding: 12px 20px;
    border-radius: 6px;
    cursor: pointer;
    transition: background-color 0.3s;
  }
  #send-order-btn:hover,
  #send-order-btn:focus {
    background: #1e874b;
  }
  /* Errori */
  .error {
    color: #c0392b;
    font-size: 13px;
    margin-top: -8px;
    margin-bottom: 10px;
  }
</style>
</head>
<body>

<h1 id="title">Menù Ordinabile</h1>

<div id="language-selector" role="group" aria-label="Selettore lingua">
  <button aria-label="Italiano" data-lang="it" type="button">🇮🇹</button>
  <button aria-label="English" data-lang="en" type="button">🇬🇧</button>
  <button aria-label="Français" data-lang="fr" type="button">🇫🇷</button>
  <button aria-label="العربية" data-lang="ar" type="button">🇸🇦</button>
</div>

<div id="menu-static" aria-live="polite">
  <!-- Menu statico sarà generato via JS -->
</div>

<button id="open-order-btn" aria-expanded="false" aria-controls="order-form-container">Apri modulo ordine</button>

<div id="order-form-container">
  <form id="order-form" aria-label="Modulo ordine">
    <fieldset>
      <legend id="legend-order">Seleziona i prodotti</legend>
      <label for="category-select" id="label-category">Categoria</label>
      <select id="category-select" aria-describedby="desc-category" required>
        <option value="" disabled selected>--</option>
      </select>

      <label for="product-select" id="label-product">Prodotto</label>
      <select id="product-select" aria-describedby="desc-product" required disabled>
        <option value="" disabled selected>--</option>
      </select>

      <label for="quantity-input" id="label-quantity">Quantità</label>
      <input type="number" id="quantity-input" min="1" max="99" value="1" required />

      <button type="button" id="add-to-cart-btn">Aggiungi al carrello</button>
    </fieldset>

    <fieldset>
      <legend id="legend-client">Dati cliente</legend>

      <label for="client-name" id="label-name">Nome</label>
      <input type="text" id="client-name" required autocomplete="given-name" />

      <label for="client-surname" id="label-surname">Cognome</label>
      <input type="text" id="client-surname" required autocomplete="family-name" />

      <label for="client-phone" id="label-phone">Telefono</label>
      <input type="tel" id="client-phone" required autocomplete="tel" pattern="[\d\s+\-()]{6,}" placeholder="+39 333 1234567" />

      <label for="client-email" id="label-email">Email</label>
      <input type="email" id="client-email" autocomplete="email" />

      <label for="client-note" id="label-note">Note</label>
      <textarea id="client-note" rows="2" placeholder="Es. senza glutine"></textarea>
    </fieldset>

    <div id="cart-summary" aria-live="polite" aria-atomic="true">
      <h2 id="cart-title">Carrello</h2>
      <ul id="cart-items">
        <!-- elementi carrello -->
      </ul>
      <div id="cart-total">Totale: € 0.00</div>
    </div>

    <button type="submit" id="send-order-btn">Invia ordine via WhatsApp</button>
  </form>
</div>

<script>
(() => {
  "use strict";

  // Dati del menù con traduzioni e prezzi
  const menuData = {
    it: {
      categories: {
        antipasti: "Antipasti",
        primi: "Primi Piatti",
        secondi: "Secondi Piatti",
        dolci: "Dolci"
      },
      dishes: {
        antipasti: [
          { id: "bruschetta", name: "Bruschetta al Pomodoro", price: 5.5 },
          { id: "carpaccio", name: "Carpaccio di Manzo", price: 8.0 }
        ],
        primi: [
          { id: "lasagne", name: "Lasagne alla Bolognese", price: 9.5 },
          { id: "carbonara", name: "Spaghetti alla Carbonara", price: 8.5 }
        ],
        secondi: [
          { id: "bistecca", name: "Bistecca alla Fiorentina", price: 18.0 },
          { id: "pollo", name: "Pollo alla Cacciatora", price: 12.0 }
        ],
        dolci: [
          { id: "tiramisu", name: "Tiramisù", price: 5.0 },
          { id: "panna", name: "Panna Cotta", price: 4.5 }
        ]
      },
      labels: {
        title: "Menù Ordinabile",
        openOrder: "Apri modulo ordine",
        closeOrder: "Chiudi modulo ordine",
        selectCategory: "Categoria",
        selectProduct: "Prodotto",
        quantity: "Quantità",
        addToCart: "Aggiungi al carrello",
        clientDataLegend: "Dati cliente",
        name: "Nome",
        surname: "Cognome",
        phone: "Telefono",
        email: "Email",
        note: "Note",
        cartTitle: "Carrello",
        total: "Totale",
        sendOrder: "Invia ordine via WhatsApp",
        legendOrder: "Seleziona i prodotti"
      }
    },
    en: {
      categories: {
        antipasti: "Starters",
        primi: "First Courses",
        secondi: "Main Courses",
        dolci: "Desserts"
      },
      dishes: {
        antipasti: [
          { id: "bruschetta", name: "Tomato Bruschetta", price: 5.5 },
          { id: "carpaccio", name: "Beef Carpaccio", price: 8.0 }
        ],
        primi: [
          { id: "lasagne", name: "Bolognese Lasagna", price: 9.5 },
          { id: "carbonara", name: "Spaghetti Carbonara", price: 8.5 }
        ],
        secondi: [
          { id: "bistecca", name: "Florentine Steak", price: 18.0 },
          { id: "pollo", name: "Hunter-style Chicken", price: 12.0 }
        ],
        dolci: [
          { id: "tiramisu", name: "Tiramisu", price: 5.0 },
          { id: "panna", name: "Panna Cotta", price: 4.5 }
        ]
      },
      labels: {
        title: "Order Menu",
        openOrder: "Open Order Form",
        closeOrder: "Close Order Form",
        selectCategory: "Category",
        selectProduct: "Product",
        quantity: "Quantity",
        addToCart: "Add to Cart",
        clientDataLegend: "Client Details",
        name: "Name",
        surname: "Surname",
        phone: "Phone",
        email: "Email",
        note: "Notes",
        cartTitle: "Cart",
        total: "Total",
        sendOrder: "Send Order via WhatsApp",
        legendOrder: "Select products"
      }
    },
    fr: {
      categories: {
        antipasti: "Entrées",
        primi: "Plats premiers",
        secondi: "Plats principaux",
        dolci: "Desserts"
      },
      dishes: {
        antipasti: [
          { id: "bruschetta", name: "Bruschetta Tomate", price: 5.5 },
          { id: "carpaccio", name: "Carpaccio de Boeuf", price: 8.0 }
        ],
        primi: [
          { id: "lasagne", name: "Lasagne à la Bolognaise", price: 9.5 },
          { id: "carbonara", name: "Spaghetti Carbonara", price: 8.5 }
        ],
        secondi: [
          { id: "bistecca", name: "Steak Florentin", price: 18.0 },
          { id: "pollo", name: "Poulet Chasseur", price: 12.0 }
        ],
        dolci: [
          { id: "tiramisu", name: "Tiramisu", price: 5.0 },
          { id: "panna", name: "Panna Cotta", price: 4.5 }
        ]
      },
      labels: {
        title: "Menu à Commander",
        openOrder: "Ouvrir le formulaire",
        closeOrder: "Fermer le formulaire",
        selectCategory: "Catégorie",
        selectProduct: "Produit",
        quantity: "Quantité",
        addToCart: "Ajouter au panier",
        clientDataLegend: "Informations client",
        name: "Prénom",
        surname: "Nom",
        phone: "Téléphone",
        email: "Email",
        note: "Notes",
        cartTitle: "Panier",
        total: "Total",
        sendOrder: "Envoyer la commande via WhatsApp",
        legendOrder: "Sélectionnez les produits"
      }
    },
    ar: {
      categories: {
        antipasti: "المقبلات",
        primi: "المعكرونة",
        secondi: "الأطباق الرئيسية",
        dolci: "الحلويات"
      },
      dishes: {
        antipasti: [
          { id: "bruschetta", name: "بروشيتا بالطماطم", price: 5.5 },
          { id: "carpaccio", name: "كارباشيو اللحم", price: 8.0 }
        ],
        primi: [
          { id: "lasagne", name: "لازانيا بولونيز", price: 9.5 },
          { id: "carbonara", name: "سباغيتي كاربونارا", price: 8.5 }
        ],
        secondi: [
          { id: "bistecca", name: "ستيك فلورنتين", price: 18.0 },
          { id: "pollo", name: "دجاج صياد", price: 12.0 }
        ],
        dolci: [
          { id: "tiramisu", name: "تيراميسو", price: 5.0 },
          { id: "panna", name: "بانا كوتا", price: 4.5 }
        ]
      },
      labels: {
        title: "قائمة الطلبات",
        openOrder: "فتح نموذج الطلب",
        closeOrder: "إغلاق نموذج الطلب",
        selectCategory: "الفئة",
        selectProduct: "المنتج",
        quantity: "الكمية",
        addToCart: "أضف إلى السلة",
        clientDataLegend: "بيانات العميل",
        name: "الاسم",
        surname: "اللقب",
        phone: "الهاتف",
        email: "البريد الإلكتروني",
        note: "ملاحظات",
        cartTitle: "السلة",
        total: "الإجمالي",
        sendOrder: "إرسال الطلب عبر واتساب",
        legendOrder: "اختر المنتجات"
      }
    }
  };

  let currentLang = "it";

  // Stato carrello: array di { category, id, name, price, qty }
  let cart = [];

  // Elementi DOM
  const elMenuStatic = document.getElementById("menu-static");
  const elLangButtons = document.querySelectorAll("#language-selector button");
  const elOpenOrderBtn = document.getElementById("open-order-btn");
  const elOrderFormContainer = document.getElementById("order-form-container");
  const elCategorySelect = document.getElementById("category-select");
  const elProductSelect = document.getElementById("product-select");
  const elQuantityInput = document.getElementById("quantity-input");
  const elAddToCartBtn = document.getElementById("add-to-cart-btn");
  const elCartItems = document.getElementById("cart-items");
  const elCartTotal = document.getElementById("cart-total");
  const elSendOrderBtn = document.getElementById("send-order-btn");
  const elOrderForm = document.getElementById("order-form");
  const elClientName = document.getElementById("client-name");
  const elClientSurname = document.getElementById("client-surname");
  const elClientPhone = document.getElementById("client-phone");
  const elClientEmail = document.getElementById("client-email");
  const elClientNote = document.getElementById("client-note");
  const elTitle = document.getElementById("title");
  const elLegendOrder = document.querySelector("#order-form fieldset legend");
  const elLabelCategory = document.getElementById("label-category");
  const elLabelProduct = document.getElementById("label-product");
  const elLabelQuantity = document.getElementById("label-quantity");
  const elLabelName = document.getElementById("label-name");
  const elLabelSurname = document.getElementById("label-surname");
  const elLabelPhone = document.getElementById("label-phone");
  const elLabelEmail = document.getElementById("label-email");
  const elLabelNote = document.getElementById("label-note");
  const elCartTitle = document.getElementById("cart-title");
  const elOpenOrderBtnAria = elOpenOrderBtn;

  // Funzione per aggiornare il menù statico visibile
  function renderStaticMenu() {
    const data = menuData[currentLang];
    elMenuStatic.innerHTML = "";
    for (const catKey in data.categories) {
      const
